<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Clue-less</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- Includes -->
    <script type="text/javascript" src="/phaser-2.4.3/build/phaser.min.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="js/Boot.js"></script>
    <script type="text/javascript" src="js/Preload.js"></script>
    <script type="text/javascript" src="js/Game.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/main.js"></script>
</head>
<script src="/socket.io/socket.io.js"></script>
<body>
<div>
    <ul id="messages"></ul>
</div>

<!--Drop down menu to select Character-->
<div>
    Select Character </br>
    <select name = "characters" id = "myCharacter"></select>
    <button type = "button" id ="join">Join Game!</button>
</div>

<!--The notepad for keep deducting an accusation-->
<div class = "notepad">
    Suspects </br>
    <input type = "checkbox" /> Col. Mustard </br>
    <input type = "checkbox" /> Professor Plub </br>
    <input type = "checkbox" /> Mr. Green </br>
    <input type = "checkbox" /> Mrs. Peakcock </br>
    <input type = "checkbox" /> Miss Scarlet </br>
    <input type = "checkbox" /> Mrs. White </br>
    Weapons</br>
    <input type = "checkbox" /> Knife </br>
    <input type = "checkbox" /> Candlestick </br>
    <input type = "checkbox" /> Revolver </br>
    <input type = "checkbox" /> Rope </br>
    <input type = "checkbox" /> Lead Pipe </br>
    <input type = "checkbox" /> Wrench </br>
    Room</br>
    <input type = "checkbox" /> Hall </br>
    <input type = "checkbox" /> Lounge </br>
    <input type = "checkbox" /> Dining Room </br>
    <input type = "checkbox" /> Kitchen </br>
    <input type = "checkbox" /> Ballroom </br>
    <input type = "checkbox" /> Conservatory </br>
    <input type = "checkbox" /> Billiard Room </br>
    <input type = "checkbox" /> Library </br>
    <input type = "checkbox" /> Study </br>
</div>

<div class = "wrapper">
    <button type = "input" id ="startGame" style = {display:block}>Start Game!</button>
</div>

<!--Place holder Board image-->
<img src ="/public/Board.png" class = board>


<!-- Right side panel-->
<div class ="player-options">
    <!--TODO: append hand of cards to this list-->

    <div>
        <ul id = "cards"></ul>
    </div>
    <!--Dynamically create update tables here status' to maintain a tally before utilizing a GUI-->
    <div id = "weaponTable"></div>
    <div id = "characterTable"></div>
    Your Current Hand </br>
    <select name = "myHand" id = "myHand"></select>
    <button type = "input" id ="disproveButton">Disprove!</button>
    <form>
        <!-- Drop down menus for moving and making accusations-->
        <label for ="location">Move to:</label>
        <select name = "location" id = "location"></select>
        <button type = "button" id="moveButton">Move!</button>
        </br>
        <span style="display:inline-block">
        <label for ="characters">Characters</label>
    <select name = "characters" id = "characters">
        <option value="mustard">Col. Mustard</option>
        <option value="plum">Professor Plum</option>
        <option value="green">Mr. Green</option>
        <option value="peacock">Mrs. Peacock</option>
        <option value="scarlet">Miss Scarlet</option>
        <option value="white">Mrs. White</option>
    </select>
            </span>
        <span style="display:inline-block">
        <label for ="weapons">Weapons</label>
        <select name = "weapons" id="weapons">
            <option value="knife">Knife</option>
            <option value="candlestick">Candlestick</option>
            <option value="revolver">Revolver</option>
            <option value="rope">Rope</option>
            <option value="lead pipe">Lead Pipe</option>
            <option value="wrench">Wrench</option>
        </select>
            </span>
        </br>
        <button type ="button">Make a suggestion!</button>
        <button type ="button">Make an accusation!</button>
    </form>
</div>
<!--
    <form action="" class = "mbar">
        <input id="m" autocomplete="off" /><button>Send</button>
    </form> -->
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>
    var socket = io();
    $('form').submit(function(){
        socket.emit('message', $('#m').val());
        $('#m').val('');
        return false;
    });

    //Scrolling update status bar
    socket.on('message', function(msg){
        $('#messages').prepend($('<li>').text(msg));
    });

    //Disable the start button until 6 players have connected
    socket.on('gameReady', function(ready) {
        if(ready == false)
            $('#startGame').prop("disabled", true);
        else
            $('#startGame').prop("disabled", false);
    });

    //Dynamically create the update table with weapon locations
    socket.on('updateWeapons', function(weapons) {
        $('#messages').prepend($('<li>').text('Updating the weapon locations'));
        $('#weaponTable' ).empty();
        $('#weaponTable').append('<table></table>');
        var table = $('#weaponTable').children();
        table.append("<tr><td>Weapon</td><td>Location</td></tr>");
        for(var i =0; i<weapons.length; i++){
            var row = "<tr>";
            row+="<td>" + weapons[i].name + "</td>" +
                    "<td>" + weapons[i].location.name + "</td>";
            row+="</tr>";
            table.append(row);

        }
    });
    //Dynamically update characterTablw with character locations
    socket.on('updateCharacters', function(characters){
        $('#messages').prepend($('<li>').text('Updating the character locations'));
        $('#characterTable' ).empty();
        $('#characterTable').append('<table></table>');
        var table = $('#characterTable').children();
        table.append("<tr><td>Character</td><td>Location</td></tr>");
        for(var i =0; i<characters.length; i++){
            var row = "<tr>";
            row+="<td>" + characters[i].name + "</td>" +
                    "<td>" + characters[i].location.name + "</td>";
            row+="</tr>";
            table.append(row);

        }
    });
    //Append the list of Available players to the drop down menu
    socket.on('viewPlayers', function(player){
        $('#myCharacter').append($('<option>', {
            value:player[0],
            text:player[1]
        }));
    });

    //populate the players hand on the screen
    socket.on('deck', function(hand) {
        for (i = 0; i < hand.length; i++){
            $('#myHand').append($('<option>', {
                value:hand[i].name,
                text:hand[i].name
            }));

        }
    });

    //Populating the moveTo menu
    socket.on('makeMove', function(rooms) {
        for(i = 0; i <rooms.length; i++) {
            $('#location').append($('<option>', {
                value: rooms[i].id,
                text: rooms[i].name
            }));
        }
    });

    //send the id of the room to move the player to
    $('#moveButton').click(function() {
        socket.emit('movePlayer', $('#location').val());
        $('#location').empty();

    });

    //Selecting a character functionality
    $('#join').click(function() {
        socket.emit('select-character',
                $('#myCharacter option:selected').text());
        $('#join').prop("disabled", true);
        $('#myCharacter').prop("disabled", true);

    });

    //Setting up the disprove button to broadcast their chosen card
    $('#disproveButton').click(function() {
        socket.emit('disprove', $('#myHand option:selected').text());
    });

    //TODO: implement startGame functionality
    $('#startGame').click(function() {
        socket.emit('startGame');
    })

</script>
</body>
</html>
